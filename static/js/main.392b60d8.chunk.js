(this["webpackJsonpdsr-editor"]=this["webpackJsonpdsr-editor"]||[]).push([[0],{221:function(t,e){},330:function(t,e,n){},357:function(t,e){},363:function(t,e){},365:function(t,e){},375:function(t,e){},377:function(t,e){},387:function(t,e){},388:function(t,e){},431:function(t,e){},433:function(t,e){},440:function(t,e){},441:function(t,e){},521:function(t,e,n){},522:function(t,e,n){"use strict";n.r(e);var o=n(1),a=n.n(o),r=n(286),c=n.n(r),i=(n(330),n(12)),s=n(574),l=n(603),d=n(573),u=n(31),b=n(535),j=n(572),x=n(594),h=n(596),f=n(590),m=n(44),O=Object(o.createContext)({authState:{isLoggedIn:!1,walletAddr:""},authDispatcher:function(){}}),p=Object(o.createContext)({isLoading:!1,setIsLoading:function(){}}),g=Object(o.createContext)({name:void 0,setName:void 0,roomId:void 0,room:void 0,isModified:!1,currentEditPlace:0,setCurrentEditPlace:void 0,meta:void 0,setMeta:void 0}),v=n(147),w=n.n(v),y="atk",C="addr",k={};Object.defineProperty(k,"authToken",{get:function(){return localStorage.getItem(y)},set:function(t){localStorage.setItem(y,t)}}),Object.defineProperty(k,"walletAddr",{get:function(){return w.a.load(C)},set:function(t){w.a.save(C,t,{path:"/"})}}),k.clearAccountData=function(){localStorage.removeItem(y),w.a.remove(C)};var S=k,I=function(t,e){var n,o=e.type,a=e.payload;console.log("dispatcher got state: ",o);var r=null!==(n=null===a||void 0===a?void 0:a.walletAddr)&&void 0!==n?n:"",c=null===a||void 0===a?void 0:a.token;switch(o){case L.AUTO_SYNC:return c?(S.authToken=c,t):t;case L.LOGIN:return S.authToken=c,S.walletAddr=r,{isLoggedIn:!0,walletAddr:r};case L.LOGOUT:return S.clearAccountData(),{isLoggedIn:!1,walletAddr:""};default:return t}},L={AUTO_SYNC:0,LOGIN:1,LOGOUT:2},A=n(55),D=n(0),E=n.n(D),T=n(100),z=n(295),R=n(304),W=n(6),P=n(5),U=n(9),F=n(10),G=n(17),N=n(298),B=n.n(N),M=(n(493),B.a.create({baseURL:"https://stormy-temple-44410.herokuapp.com/"}));M.interceptors.request.use((function(t){var e=S.authToken;return t.headers.Authorization=e?"Bearer ".concat(e):"",t}));var H=function(t){Object(U.a)(n,t);var e=Object(F.a)(n);function n(t){var o;for(var a in Object(P.a)(this,n),o=e.call(this),t)o.append(a,t[a]);return o}return Object(W.a)(n)}(Object(G.a)(FormData)),_=function(){var t=Object(A.a)(E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.get("/renew_token").then((function(t){return t.data.access_token}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),q=function(){var t=Object(A.a)(E.a.mark((function t(e){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.get("/login/".concat(e,"/payload")).then((function(t){return t.data.payload}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Y=function(){var t=Object(A.a)(E.a.mark((function t(e,n){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.post("/login",new H({address:e,signature:n})).then((function(t){return t.data.access_token}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),J=function(){var t=Object(A.a)(E.a.mark((function t(e){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.get("/collections",{params:e}).then((function(t){return t.data}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),V=function(){var t=Object(A.a)(E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.get("/rooms").then((function(t){return t.data}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),K=function(){var t=Object(A.a)(E.a.mark((function t(e,n){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.post("/rooms/create",new H({name:e,image:null!==n&&void 0!==n?n:""})).then((function(t){return t.data.id}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Q=function(){var t=Object(A.a)(E.a.mark((function t(e,n){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.put("/rooms/".concat(e,"/update"),n).then((function(t){return t.data}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),X=function(){var t=Object(A.a)(E.a.mark((function t(e){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.delete("/rooms/".concat(e,"/delete"));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Z=new T.a("https://mainnet-tezos.giganode.io"),$=new z.a({name:"D Showroom"});Z.setWalletProvider($);var tt=function(){var t=Object(o.useContext)(p).setIsLoading,e=Object(o.useContext)(O),n=(e.authState,e.authDispatcher),a=Object(o.useState)(""),r=Object(i.a)(a,2),c=r[0],s=r[1],l=function(){var t=Object(A.a)(E.a.mark((function t(){var e,n;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$.client.getActiveAccount();case 2:(e=t.sent)?(n=e.address,c===n?console.log("Already connected: ",n):console.log("Another wallet connected: ",n)):console.log("No wallet connnection!");case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=function(){var e=Object(A.a)(E.a.mark((function e(){var o,a,r,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(!0),e.prev=1,console.log("Requesting permissions..."),e.next=5,$.client.requestPermissions();case 5:return o=e.sent,a=o.address,s(a),console.log("Get permission. Get payload..."),e.next=11,q(a);case 11:return r=e.sent,console.log("Get payload. Request signature..."),e.next=15,$.client.requestSignPayload({signingType:R.a.MICHELINE,payload:r});case 15:return c=e.sent,console.log("Get signature. Try login..."),e.next=19,Y(a,c.signature).then((function(t){console.log("Login suceed!"),n({type:L.LOGIN,payload:{walletAddr:a,token:t}})}));case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(1),s(""),console.log("Got error:",e.t0);case 25:t(!1);case 26:case"end":return e.stop()}}),e,null,[[1,21]])})));return function(){return e.apply(this,arguments)}}();return{walletAddr:c,connectWallet:d,checkWalletConnection:l}},et=n(40),nt=n(2),ot=function(t){var e=t.children,n=t.to,o="/"+Object(u.g)().pathname.split("/")[1]===n;return Object(nt.jsx)(m.b,{to:n,children:Object(nt.jsx)(b.a,{color:o?"text.primary":"text.secondary",sx:{fontSize:{sm:"1rem",xs:"0.875rem"},mr:4,fontWeight:"bold",position:"relative","&::after":o?{position:"absolute",content:"''",height:2,bottom:-3,margin:"0 auto",left:0,right:0,width:"100%",backgroundColor:"text.primary"}:{}},children:e})})},at=function(){var t,e,n,a=Object(o.useContext)(O),r=a.authState,c=a.authDispatcher,i=tt().connectWallet,s=Object(et.a)(),l=Object(j.a)(s.breakpoints.up("sm"));return Object(nt.jsx)(x.a,{color:"default",enableColorOnDark:!0,children:Object(nt.jsxs)(h.a,{children:[Object(nt.jsx)(m.b,{to:"/",children:Object(nt.jsx)("img",{style:{height:40},src:l?"/DSR-Editor/logo_full.svg":"/DSR-Editor/logo.svg",alt:"D SHOWROOM"})}),Object(nt.jsx)(b.a,{sx:{flexGrow:1}}),null!==r&&void 0!==r&&r.isLoggedIn?Object(nt.jsxs)(nt.Fragment,{children:[Object(nt.jsx)(ot,{to:"/rooms",children:"Rooms"}),Object(nt.jsx)(ot,{to:"/collections",children:"Collections"}),Object(nt.jsx)(f.a,{variant:"outlined",sx:{textTransform:"none"},onDoubleClick:function(){c({type:L.LOGOUT})},children:l?(null===r||void 0===r||null===(t=r.walletAddr)||void 0===t?void 0:t.slice(0,5))+"..."+(null===r||void 0===r||null===(e=r.walletAddr)||void 0===e?void 0:e.slice(-5)):"..."+(null===r||void 0===r||null===(n=r.walletAddr)||void 0===n?void 0:n.slice(-3))})]}):Object(nt.jsx)(f.a,{variant:"outlined",onClick:function(){i()},children:"Connect"})]})})},rt=n(32),ct=function(){var t=Object(u.h)(),e=Object(o.useContext)(O).authState,n=tt().connectWallet;return Object(nt.jsxs)(d.a,{sx:{height:"100%",width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[Object(nt.jsx)("img",{style:{minWidth:200,width:"50%",maxWidth:400,marginBottom:24},src:"/DSR-Editor/images/welcome.svg",alt:"Welcome to DSR."}),Object(nt.jsx)(f.a,{sx:{textAlign:"center",padding:2,mt:2.5},size:"large",onClick:null!==e&&void 0!==e&&e.isLoggedIn?function(e){t("/rooms"),e.preventDefault()}:function(t){n(),t.preventDefault()},href:"/rooms",children:Object(nt.jsx)(b.a,{variant:"h6",children:null!==e&&void 0!==e&&e.isLoggedIn?"Get Started":"Connect to Start"})})]})},it=function(){return Object(nt.jsxs)(d.a,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[Object(nt.jsx)("img",{src:"/DSR-Editor/logo.svg",alt:"logo",style:{maxWidth:200,width:"30%"}}),Object(nt.jsx)(b.a,{variant:"h3",color:"text.primary",sx:{textAlign:"center",mt:8,fontWeight:"bold"},children:"Nothing = ="})]})},st=n(591),lt=n(581),dt=n(597),ut=n(598),bt=n(599),jt=n(600),xt=n(583),ht=n(601),ft=n(602),mt=n(579),Ot=n(604),pt=n(605),gt=n(584),vt=n(606),wt=n(301),yt=n.n(wt),Ct=n(300),kt=n.n(Ct),St=n(142),It=n(588),Lt=n(299),At=n.n(Lt),Dt=["id","variant","color","sx"],Et=function(t){var e=t.id,n=t.variant,a=t.color,r=t.sx,c=Object(St.a)(t,Dt),s=Object(o.useState)(!1),l=Object(i.a)(s,2),d=l[0],u=l[1];return Object(nt.jsxs)(nt.Fragment,{children:[Object(nt.jsx)(xt.a,{title:"Click to copy",arrow:!0,followCursor:!0,children:Object(nt.jsxs)(b.a,Object(rt.a)(Object(rt.a)({variant:null!==n&&void 0!==n?n:"body2",color:null!==a&&void 0!==a?a:"text.secondary",sx:Object(rt.a)({fontSize:{sm:"0.875rem",xs:"0.75rem"},height:"fit-content",width:"fit-content",display:"flex",flexDirection:"row",alignItems:"center",cursor:"pointer",lineHeight:1,"&:hover":{color:"text.primary",textDecoration:"underline dotted 2px"}},null!==r&&void 0!==r?r:{}),onClick:function(){navigator.clipboard.writeText(e).then((function(){u(!0)}))}},c),{},{children:[Object(nt.jsx)(At.a,{fontSize:"small",sx:{mr:.5,fontSize:{sm:"1.25rem",xs:"1rem"}}}),e]}))}),Object(nt.jsx)(It.a,{open:d,autoHideDuration:1e3,anchorOrigin:{vertical:"bottom",horizontal:"center"},onClose:Object(o.useCallback)((function(){u(!1)}),[]),message:"Room ID copied.",sx:{"& .MuiPaper-root":{maxWidth:"max-content",minWidth:"max-content",pl:3,pr:3}}})]})},Tt=function(t){var e,n=t.room,a=t.refetch,r=null!==n&&void 0!==n?n:{},c=r.image,s=r.name,l=r.id,j=Object(o.useState)(!1),x=Object(i.a)(j,2),h=x[0],m=x[1],O=Object(o.useContext)(p).setIsLoading,g=Object(o.useState)(!1),v=Object(i.a)(g,2),w=v[0],y=v[1],C=Object(o.useState)(""),k=Object(i.a)(C,2),S=k[0],I=k[1],L=Object(u.h)(),A=!s;return Object(nt.jsxs)(nt.Fragment,{children:[Object(nt.jsxs)(dt.a,{sx:{width:360,margin:2,height:"max-content"},children:[Object(nt.jsxs)(d.a,{sx:{width:"100%",height:"auto",aspectRatio:"15/9",position:"relative",backgroundColor:"background.paper"},children:[!A&&Object(nt.jsx)(ut.a,{component:"img",loading:"lazy",sx:{objectFit:"cover",width:"100%",height:"100%",zIndex:1,position:"absolute",top:0},onLoad:function(){m(!0)},image:(null!==(e=null===c||void 0===c?void 0:c.length)&&void 0!==e?e:0)>0?c:"/DSR-Editor/images/default.png"}),!h&&Object(nt.jsx)(bt.a,{sx:{zIndex:0,position:"absolute",top:0},variant:"rectangular",width:"100%",height:"100%",animation:"wave"})]}),Object(nt.jsxs)(jt.a,{sx:{pt:1,"&:last-child":{paddingBottom:{sm:1.5,xs:1}},position:"relative"},children:[Object(nt.jsx)(b.a,{variant:"h6",sx:{mb:.5,lineHeight:1.6,width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:A?Object(nt.jsx)(bt.a,{}):s}),A?Object(nt.jsx)(bt.a,{width:"40%"}):Object(nt.jsx)(Et,{id:l}),!A&&Object(nt.jsxs)(nt.Fragment,{children:[Object(nt.jsx)(xt.a,{title:"Delete",placement:"top",arrow:!0,componentsProps:{tooltip:{style:{marginBottom:8}}},children:Object(nt.jsx)(ht.a,{color:"error",size:"small",sx:{color:"error.light",position:"absolute",right:{sm:48,xs:40},bottom:{sm:8,xs:4}},onClick:function(){y(!0)},children:Object(nt.jsx)(kt.a,{sx:{fontSize:{sm:"1.5rem",xs:"1.25rem"}}})})}),Object(nt.jsx)(xt.a,{title:"Edit",placement:"top",arrow:!0,componentsProps:{tooltip:{style:{marginBottom:8}}},children:Object(nt.jsx)(ht.a,{color:"primary",size:"small",sx:{color:"primary.light",position:"absolute",right:8,bottom:{sm:8,xs:4}},onClick:function(){L(l)},children:Object(nt.jsx)(yt.a,{sx:{fontSize:{sm:"1.5rem",xs:"1.25rem"}}})})})]})]})]}),Object(nt.jsxs)(ft.a,{open:w,maxWidth:"xs",fullWidth:!0,children:[Object(nt.jsx)(mt.a,{children:"Are you sure to delete the room?"}),Object(nt.jsxs)(Ot.a,{children:[Object(nt.jsxs)(pt.a,{component:"span",children:["Type the room name"," ",Object(nt.jsx)(b.a,{component:"span",color:"error",fontWeight:"bold",children:s})]}),Object(nt.jsx)(gt.a,{variant:"standard",fullWidth:!0,value:S,onChange:Object(o.useCallback)((function(t){I(t.target.value)}),[])})]}),Object(nt.jsxs)(vt.a,{children:[Object(nt.jsx)(f.a,{onClick:Object(o.useCallback)((function(){y(!1)}),[]),children:"Cancel"}),Object(nt.jsx)(f.a,{color:"error",disabled:S!==s,onClick:function(){y(!1),O(!0),X(l).then((function(){null===a||void 0===a||a().then((function(){O(!1)}))}))},children:"Delete"})]})]})]})},zt=n(302),Rt=n.n(zt),Wt=["limit","value","onChange","showCount"],Pt=function(t){var e,n=t.limit,a=void 0===n?32:n,r=t.value,c=t.onChange,s=t.showCount,l=void 0===s||s,d=Object(St.a)(t,Wt),u=Object(o.useState)(""),b=Object(i.a)(u,2),j=b[0],x=b[1],h=Object(o.useState)(!1),f=Object(i.a)(h,2),m=f[0],O=f[1],p=Object(o.useState)(null!==(e=null===j||void 0===j?void 0:j.length)&&void 0!==e?e:0),g=Object(i.a)(p,2),v=g[0],w=g[1];Object(o.useEffect)((function(){w(y(r)),x(r)}),[r]);var y=function(t){var e,n=0;return null===t||void 0===t||null===(e=t.split(""))||void 0===e||e.forEach((function(t){t.match(/[\u0000-\u00ff]/)?n+=1:n+=2})),n},C=function(t){var e=function(t,e){var n,o=[];return null===t||void 0===t||null===(n=t.split(""))||void 0===n||n.forEach((function(t){t.match(/[\u0000-\u00ff]/)?o.push(t):o.push("",t)})),o.slice(0,e).join("")}(t.target.value,a);if(!m){t.target.value=e;var n=y(e);w(n)}x(e),null===c||void 0===c||c(t)};return Object(nt.jsx)(gt.a,Object(rt.a)({value:j,onChange:C,inputProps:{onCompositionStart:Object(o.useCallback)((function(t){O(!0)}),[]),onCompositionEnd:Object(o.useCallback)((function(t){C(t),O(!1)}),[]),onBlur:Object(o.useCallback)((function(t){t.target.value=t.target.value.trim(),C(t)}),[])},helperText:l?"(".concat(v,"/").concat(a,")"):void 0},d))},Ut=function(t){var e=t.open,n=t.onClose,a=Object(u.h)(),r=Object(o.useState)(""),c=Object(i.a)(r,2),s=c[0],l=c[1],d=Object(o.useContext)(p).setIsLoading;return Object(nt.jsxs)(ft.a,{open:e,PaperProps:{sx:{padding:1}},onClose:n,children:[Object(nt.jsx)(mt.a,{sx:{pb:1},children:"Create New Showroom"}),Object(nt.jsxs)(Ot.a,{children:[Object(nt.jsx)(pt.a,{sx:{mb:2},children:"To create a new showroom, please give it a name."}),Object(nt.jsx)("img",{style:{aspectRatio:"16/9",objectFit:"cover"},width:"100%",alt:"default",src:"/DSR-Editor/images/default.png"}),Object(nt.jsx)(Pt,{sx:{mt:2},variant:"standard",fullWidth:!0,placeholder:"Showroom name",value:s,onChange:Object(o.useCallback)((function(t){l(t.target.value)}),[])})]}),Object(nt.jsxs)(vt.a,{sx:{pr:2},children:[Object(nt.jsx)(f.a,{onClick:n,color:"error",children:"Cancel"}),Object(nt.jsx)(f.a,{onClick:function(){d(!0),0===s.trim().length&&alert("Please set a name."),K(s).then((function(t){d(!1),a(t)}))},disabled:!s,children:"Create"})]})]})},Ft=function(){var t=Object(u.i)(),e=t.roomList,n=t.fetchRooms,a=Object(o.useState)(!1),r=Object(i.a)(a,2),c=r[0],s=r[1],l={item:!0,container:!0,direction:"row",justifyContent:"center",xs:12,md:6,lg:4,xl:3};return Object(nt.jsxs)(lt.a,{sx:{padding:"36px 24px",boxSizing:"border-box",width:"100%"},children:[Object(nt.jsx)(st.a,{container:!0,direction:"row",sx:{margin:"auto",width:"90%",maxWidth:1600},children:e?Object(nt.jsxs)(nt.Fragment,{children:[e.map((function(t){return Object(nt.jsx)(st.a,Object(rt.a)(Object(rt.a)({},l),{},{children:Object(nt.jsx)(Tt,{room:t,refetch:n})}),t.id)})),Object(nt.jsxs)(st.a,Object(rt.a)(Object(rt.a)({},l),{},{position:"relative",color:"divider",sx:{width:"max-content"},children:[Object(nt.jsx)(Tt,{}),Object(nt.jsx)(lt.a,{sx:{position:"absolute",top:0,width:"calc(100% - 32px)",maxWidth:360,height:"calc(100% - 32px)",margin:2,backgroundColor:"background.default"}}),Object(nt.jsx)(f.a,{variant:"outlined",color:"inherit",sx:{position:"absolute",top:0,width:"calc(100% - 32px)",maxWidth:360,height:"calc(100% - 32px)",margin:2,borderWidth:3},onClick:function(){s(!0)},children:Object(nt.jsx)(Rt.a,{sx:{fontSize:80}})})]}))]}):Array.from({length:4},(function(){return{}})).map((function(t,e){return Object(nt.jsx)(st.a,Object(rt.a)(Object(rt.a)({},l),{},{children:Object(nt.jsx)(Tt,{})}),e)}))}),Object(nt.jsx)(Ut,{open:c,onClose:Object(o.useCallback)((function(){s(!1)}),[])})]})},Gt=n(148),Nt=n.n(Gt),Bt=n(3),Mt=n(592),Ht=n(587),_t=function(t){var e=t.collection,n=null!==e&&void 0!==e?e:{},a=n.name,r=n.thumbnailUri,c=n.displayUri,s=n.artifactUri,l=n.mimeType,d=!a,u=Object(o.useState)(!1),j=Object(i.a)(u,2),x=j[0],h=j[1];return Object(nt.jsxs)(dt.a,{sx:{width:270,margin:2,height:"max-content"},children:[Object(nt.jsxs)(lt.a,{sx:{width:"100%",height:"auto",position:"relative",aspectRatio:"1",backgroundColor:"background.paper"},children:[!d&&Object(nt.jsx)(ut.a,{sx:{objectFit:"contain",width:"100%",height:"100%",zIndex:1,position:"absolute",top:0},component:l.includes("video")?"video":"img",image:l.includes("image")||l.includes("video")?s:null!==c&&void 0!==c?c:r,controls:!0,loop:!0,loading:"lazy",onLoad:function(){h(!0)},onLoadStart:function(){h(!0)}}),(null===l||void 0===l?void 0:l.includes("audio"))&&Object(nt.jsx)("audio",{style:{width:"90%",height:"15%",zIndex:2,position:"absolute",bottom:"5%",left:"5%"},src:s,controls:!0}),!x&&Object(nt.jsx)(bt.a,{sx:{zIndex:0,position:"absolute",top:0},variant:"rectangular",width:"100%",height:"100%",animation:"wave"})]}),Object(nt.jsx)(jt.a,{sx:{width:"100%",boxSizing:"border-box","&:last-child":{paddingBottom:1.5}},children:Object(nt.jsx)(b.a,{variant:"body1",sx:{mb:.5,width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:d?Object(nt.jsx)(bt.a,{}):a})})]})},qt=function(){var t,e=Object(o.useState)({}),n=Object(i.a)(e,2),a=n[0],r=n[1],c=Object(o.useState)(),s=Object(i.a)(c,2),l=s[0],j=s[1],x=Object(u.g)(),h=new URLSearchParams(x.search),f=parseInt(h.get("page")||"1",10);Object(o.useEffect)((function(){var t=24*(f-1);a[f]||r(Object(rt.a)(Object(Bt.a)({},f,Array.from({length:24},(function(){return{}}))),a));var e=function(){var e=Object(A.a)(E.a.mark((function e(){var n,o,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J({offset:t});case 2:n=e.sent,o=n.tokens,c=n.count,r(Object(rt.a)(Object(Bt.a)({},f,o),a)),j(c);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[f]);var O={item:!0,container:!0,direction:"row",justifyContent:"center",xs:12,sm:6,md:4,lg:3,xl:2};return Object(nt.jsxs)(d.a,{sx:{position:"relative",padding:"36px 24px",boxSizing:"border-box",minHeight:"100%",width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(nt.jsx)(st.a,{container:!0,direction:"row",sx:{pb:10},children:null===a||void 0===a||null===(t=a[f])||void 0===t?void 0:t.map((function(t,e){var n;return Object(nt.jsx)(st.a,Object(rt.a)(Object(rt.a)({},O),{},{children:Object(nt.jsx)(_t,{collection:t})}),"collection_".concat(null!==(n=null===t||void 0===t?void 0:t.name)&&void 0!==n?n:e))}))}),0===l&&Object(nt.jsx)(b.a,{variant:"h2",color:"text.primary",sx:{textAlign:"center",mt:"5%",fontWeight:"bold"},children:"You don't have any collection!"}),(null!==l&&void 0!==l?l:0)>24&&Object(nt.jsx)(Mt.a,{color:"primary",sx:function(t){return{zIndex:100,position:"fixed",bottom:20,borderRadius:"9999px",display:"flex",backgroundColor:"".concat(t.palette.background.default,"88"),flexDirection:"row",justifyContent:"center",alignItems:"center",mt:1.5,padding:1}},page:f,count:Math.ceil(l/24),renderItem:function(t){return Object(nt.jsx)(Ht.a,Object(rt.a)({component:m.b,to:"".concat(1===t.page?"":"?page=".concat(t.page))},t))}})]})},Yt=n(303),Jt=n.n(Yt),Vt=function(){var t=Object(o.useContext)(g),e=t.name,n=t.setName,a=t.room.name,r=Object(o.useState)(!1),c=Object(i.a)(r,2),s=c[0],l=c[1];return Object(nt.jsx)(Pt,{value:e,onChange:function(t){n(t.target.value)},multiline:!0,fullWidth:!0,onFocus:function(){l(!0)},onBlur:function(t){l(!1),e.trim()||setTimeout((function(){n(a)}),100)},showCount:s,sx:function(t){return{mt:-.5,mb:-.5,ml:"-14px",border:"none","& > div":{pt:.5,pb:.5},"& textarea":Object(rt.a)({},t.typography.h3),"& fieldset":{borderColor:"transparent"},"& .MuiFormHelperText-root":{position:"absolute",right:0,bottom:-24}}}})},Kt=["A","B","C","D","E","F"],Qt=function(){var t=Object(o.useContext)(g),e=t.currentEditPlace,n=t.setCurrentEditPlace,a=function(t){n(parseInt(t.target.id))},r=[{top:"20%",right:"27%"},{bottom:"35%",right:"12%"},{top:"20%",left:"27%"},{bottom:"35%",left:"12%"},{top:"30%",right:"calc(50% - 18px)"},{bottom:"15%",right:"calc(50% - 18px)"}];return Object(nt.jsx)(d.a,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:Object(nt.jsxs)(d.a,{sx:{width:"100%",height:"auto",aspectRatio:"16/9",position:"relative"},children:[Object(nt.jsx)("img",{src:"/DSR-Editor/images/plan.png",alt:"plan",width:"100%"}),Kt.map((function(t,n){return Object(nt.jsx)(f.a,{id:n,onClick:a,variant:"contained",color:n===e?"primary":"secondary",sx:Object(rt.a)(Object(rt.a)({aspectRatio:"1",padding:"6px 6px",position:"absolute"},r[n]),{},{minWidth:0,width:"auto",height:36,borderRadius:999,boxShadow:"2px 2px 10px 2px rgba(0, 0, 0, 0.7)"}),children:t},t)}))]})})},Xt=function(){var t=Object(u.i)().setRoomList,e=Object(o.useContext)(p).setIsLoading,n=Object(u.h)(),a=Object(o.useContext)(g),r=a.name,c=a.setName,i=a.roomId,s=a.isModified,l=a.room,d=a.meta;return Object(nt.jsxs)(st.a,{container:!0,item:!0,direction:"column",xs:12,md:5.875,lg:4.875,xl:3.875,sx:{padding:2},children:[Object(nt.jsxs)(lt.a,{sx:{height:"max-content",width:"100%"},children:[Object(nt.jsxs)(lt.a,{sx:{height:"max-content",width:"100%",display:"flex",flexDirection:"row",alignItems:"center"},children:[Object(nt.jsx)(ht.a,{sx:{mr:{xs:1,sm:2}},onClick:Object(o.useCallback)((function(){n("/rooms")}),[n]),children:Object(nt.jsx)(Jt.a,{sx:{fontSize:{xs:"1.25rem",sm:"1.5rem"}}})}),void 0!==r?Object(nt.jsx)(Vt,{name:r,setName:c}):Object(nt.jsx)(b.a,{variant:"h3",color:"text.primary",sx:{width:"100%",overflow:"hidden",overflowWrap:"break-word"},children:Object(nt.jsx)(bt.a,{variant:"text"})})]}),Object(nt.jsx)(Et,{sx:{fontSize:{sm:"1.2rem",xs:"0.875rem"},ml:{xs:"44px",sm:7},mt:{xs:2,sm:2.5},mb:{xs:3,sm:5}},id:i})]}),Object(nt.jsx)(lt.a,{sx:{flexGrow:1,ml:{xs:0,md:4}},children:Object(nt.jsx)(Qt,{})}),Object(nt.jsx)(lt.a,{sx:{mt:4,mb:4,display:"flex",flexDirection:"row",justifyContent:"flex-end"},children:Object(nt.jsx)(f.a,{variant:"outlined",disabled:!s,onClick:function(){var o;e(!0);var a={};r!==l.name&&(a.name=r),-1!==(null!==(o=null===d||void 0===d?void 0:d.findIndex((function(t,e){return t.contract!==l.metadata[e].contract||t.tokenId!==l.metadata[e].tokenId})))&&void 0!==o?o:-1)&&(a.metadata=d),Q(i,a).then((function(o){t((function(t){return t.map((function(t){return t.id===i?o:t}))})),e(!1),n("/rooms")}))},children:"Save"})})]})},Zt=n(585),$t=n(607),te=["image","gif","video","audio","3dmodel"],ee=function(){var t=Object(o.useState)({}),e=Object(i.a)(t,2),n=e[0],a=e[1],r=Object(o.useState)(),c=Object(i.a)(r,2),s=c[0],l=c[1],d=Object(o.useState)({}),u=Object(i.a)(d,2),b=u[0],j=u[1],x=Object(o.useState)(),h=Object(i.a)(x,2),f=h[0],m=h[1],O=Object(o.useState)({}),p=Object(i.a)(O,2),g=p[0],v=p[1],w=Object(o.useState)(),y=Object(i.a)(w,2),C=y[0],k=y[1],S=Object(o.useState)({}),I=Object(i.a)(S,2),L=I[0],A=I[1],D=Object(o.useState)(),E=Object(i.a)(D,2),T=E[0],z=E[1],R=Object(o.useState)({}),W=Object(i.a)(R,2),P=W[0],U=W[1],F=Object(o.useState)(),G=Object(i.a)(F,2),N=G[0],B=G[1];return[[n,b,g,L,P],function(t,e,o){var r=e.tokens,c=e.count;switch("string"===typeof t&&(t=te.indexOf(t)),t){case 0:return a(Object(rt.a)(Object(Bt.a)({},o,r),n)),void l(c);case 1:return j(Object(rt.a)(Object(Bt.a)({},o,r),b)),void m(c);case 2:return v(Object(rt.a)(Object(Bt.a)({},o,r),g)),void k(c);case 3:return A(Object(rt.a)(Object(Bt.a)({},o,r),L)),void z(c);case 4:return U(Object(rt.a)(Object(Bt.a)({},o,r),P)),void B(c);default:return}},[s,f,C,T,N]]},ne=function(t){var e=t.collection,n=null!==e&&void 0!==e?e:{},a=n.contract,r=n.tokenId,c=n.name,s=n.thumbnailUri,l=n.displayUri,d=n.artifactUri,u=n.mimeType,j=Object(o.useContext)(g),x=j.meta,h=j.setMeta,f=j.currentEditPlace,m=!c,O=Object(o.useState)(!1),p=Object(i.a)(O,2),v=p[0],w=p[1],y=null===x||void 0===x?void 0:x.findIndex((function(t){return t.contract===a&&t.tokenId===r&&r})),C=function(t,e){return x.map((function(n,o){return o===t?e:n}))};return Object(nt.jsx)(dt.a,{sx:function(t){return{width:270,margin:1.5,height:"max-content",cursor:-1===y||y===f?"pointer":"not-allowed",boxShadow:-1!==(null!==y&&void 0!==y?y:-1)?"0px 0px 10px 3px ".concat(t.palette.primary.main):void 0}},onClick:function(){-1===y?h(C(f,{contract:a,tokenId:r})):y===f&&h(C(y,{}))},children:Object(nt.jsxs)(lt.a,{sx:{width:"100%",height:"auto",position:"relative",aspectRatio:"1",backgroundColor:"background.paper"},children:[-1!==(null!==y&&void 0!==y?y:-1)&&Object(nt.jsx)(lt.a,{variant:"h6",component:"span",sx:function(t){return{zIndex:5,width:"auto",height:"25%",position:"absolute",top:"5%",right:"5%",borderRadius:999,backgroundColor:"primary.main",border:"2px solid white",textAlign:"center",aspectRatio:"1",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",color:"primary.dark"}},children:Object(nt.jsx)(b.a,{variant:"h6",lineHeight:"unset",fontWeight:"bold",children:Kt[y]})}),(null===u||void 0===u?void 0:u.includes("audio"))&&Object(nt.jsx)("audio",{style:{width:"90%",height:"15%",zIndex:2,position:"absolute",bottom:"5%",left:"5%"},src:d,controls:!0}),!m&&Object(nt.jsx)(ut.a,{sx:{zIndex:1,objectFit:"contain",width:"100%",height:"100%",position:"absolute",top:0},alt:c,component:"img",image:u.includes("image")?d:null!==l&&void 0!==l?l:s,onLoad:function(){w(!0)}}),!v&&Object(nt.jsx)(bt.a,{sx:{zIndex:0,position:"absolute",top:0},variant:"rectangular",width:"100%",height:"100%",animation:"wave"})]})})},oe=(n(521),function(){var t=Object(o.useRef)();return Object(o.useEffect)((function(){var e,n=t.current,o=function(t){n&&(t.target.classList.add("scrolling"),clearTimeout(e),e=setTimeout((function(){t.target.classList.remove("scrolling")}),200))};return null===n||void 0===n||n.addEventListener("scroll",o),function(){null===n||void 0===n||n.removeEventListener("scroll",o)}}),[]),t}),ae=[[0,1,2,3],[0,1,2,3],[0,1,2,3],[0,1,2,3],[4],[4]],re=["image","gif","video","audio","3d model"],ce=function(){var t=Object(u.i)(),e=t.collectionTabIndex,n=t.setCollectionTabIndex,a=t.collectionPage,r=t.setCollectionPage,c=t.shownCollections,i=t.counts,s=Object(o.useContext)(g).currentEditPlace,l=oe(),x=Object(et.a)(),h=Object(j.a)(x.breakpoints.up("md")),f={item:!0,container:!0,direction:"row",justifyContent:"center",width:h?void 0:"25vw",minWidth:h?void 0:120,md:4,lg:3,xl:2},m=i[e],O=ae[s];Object(o.useEffect)((function(){r(1),n(O[0])}),[s]);var p=O.indexOf(e);return Object(nt.jsxs)(d.a,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",position:"relative"},children:[Object(nt.jsx)(d.a,{sx:{width:"max-content",ml:{xs:2.5,lg:2},borderBottom:1,borderColor:"divider"},children:Object(nt.jsx)(Zt.a,{value:-1!==p?p:0,onChange:function(t,e){n(e),r(1)},sx:{minHeight:{xs:32,lg:48},"& button":{padding:{xs:"8px 10px",lg:"12px 16px"},minHeight:{xs:32,lg:48},minWidth:{xs:60,lg:90},fontSize:{xs:"0.5rem",lg:"0.875rem"}}},children:O.map((function(t,e){return Object(nt.jsx)($t.a,{label:re[t],tabIndex:e},re[t])}))})}),Object(nt.jsxs)(d.a,{sx:{width:"100%",height:"100%",overflow:"auto",mt:2,display:"flex",flexDirection:"column",alignItems:h?"center":"flex-start",pb:h?6:0},ref:l,children:[Object(nt.jsx)(st.a,{container:!0,direction:"row",width:h?"100%":"max-content",sx:{mt:{xs:4,md:0}},children:null===c||void 0===c?void 0:c.map((function(t,e){var n;return Object(nt.jsx)(st.a,Object(rt.a)(Object(rt.a)({},f),{},{children:Object(nt.jsx)(ne,{collection:t})}),"collection_".concat(null!==(n=null===t||void 0===t?void 0:t.name)&&void 0!==n?n:e))}))}),0===m&&Object(nt.jsxs)(b.a,{variant:"h6",color:"text.primary",sx:{width:"100%",textAlign:"center",mt:"5%",fontWeight:"bold"},children:["No ",te[e]," collection!"]}),(null!==m&&void 0!==m?m:0)>24&&Object(nt.jsx)(d.a,{sx:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},children:Object(nt.jsx)(Mt.a,{color:"primary",sx:function(t){return{position:"absolute",zIndex:100,top:h?void 0:32,bottom:h?5:void 0,borderRadius:"9999px",display:"flex",backgroundColor:"".concat(t.palette.background.default,"88"),flexDirection:"row",justifyContent:"center",alignItems:"center",mt:1.5,padding:.5}},page:a,count:Math.ceil(m/24),onChange:function(t,e){r(O[e])},size:"small"})})]})]})},ie=function(){var t,e,n=Object(u.i)().roomList,a=Object(o.useState)(0),r=Object(i.a)(a,2),c=r[0],s=r[1],l=Object(o.useState)(),d=Object(i.a)(l,2),b=d[0],x=d[1],h=Object(o.useState)(),f=Object(i.a)(h,2),m=f[0],O=f[1],p=Object(u.j)().roomId,v=null!==(t=null===n||void 0===n?void 0:n.find((function(t){return t.id===p})))&&void 0!==t?t:{},w=v.name,y=v.metadata,C=Object(et.a)(),k=Object(j.a)(C.breakpoints.up("md"));Object(o.useEffect)((function(){O(w)}),[w]),Object(o.useEffect)((function(){x(y)}),[y]);var S=m&&m!==w||-1!==(null!==(e=null===b||void 0===b?void 0:b.findIndex((function(t,e){return t.contract!==y[e].contract||t.tokenId!==y[e].tokenId})))&&void 0!==e?e:-1);return Object(o.useEffect)((function(){var t=function(t){if(S)return t.preventDefault(),t.returnValue="Changes haven't been saved. Are you sure to leave?",t};return window.addEventListener("beforeunload",t),function(){window.removeEventListener("beforeunload",t)}}),[S]),Object(o.useEffect)((function(){s(0)}),[s]),Object(nt.jsx)(g.Provider,{value:{name:m,setName:O,roomId:p,room:v,isModified:S,currentEditPlace:c,setCurrentEditPlace:s,meta:b,setMeta:x},children:Object(nt.jsxs)(st.a,{container:!0,direction:"row",sx:{height:"100%",width:"100%",padding:{xs:"24px 8px",sm:4},boxSizing:"border-box"},children:[Object(nt.jsx)(Xt,{}),Object(nt.jsx)(st.a,{container:!0,item:!0,direction:"row",md:5.75,lg:6.75,xl:7.75,sx:{height:k?"100%":"max-content",ml:{md:2,lg:3},pl:{md:3,lg:5},padding:2,borderLeft:k?1:"none",borderColor:"divider",boxSizing:"border-box"},children:Object(nt.jsx)(ce,{})})]})})},se=function(){var t,e,n=Object(o.useState)(),a=Object(i.a)(n,2),r=a[0],c=a[1],s=ee(),l=Object(i.a)(s,3),d=l[0],b=l[1],j=l[2],x=Object(o.useState)(0),h=Object(i.a)(x,2),f=h[0],m=h[1],O=Object(o.useState)(1),p=Object(i.a)(O,2),g=p[0],v=p[1],w=Object(u.g)(),y=function(){return V().then((function(t){c(t)})).catch((function(t){alert(t)}))};Object(o.useEffect)((function(){console.log("(Re)fetch rooms..."),y()}),[w.pathname]),Object(o.useEffect)((function(){var t,e;t=g,e=te[f],J({offset:24*(t-1),mimeTypes:e}).then((function(n){b(e,n,t)}))}),[f,g]);var C=null!==(t=null===d||void 0===d||null===(e=d[f])||void 0===e?void 0:e[g])&&void 0!==t?t:Array.from({length:24},(function(){return{}}));return Object(nt.jsx)(u.b,{context:{roomList:r,setRoomList:c,fetchRooms:y,collections:d,collectionTabIndex:f,setCollectionTabIndex:m,collectionPage:g,setCollectionPage:v,shownCollections:C,counts:j}})},le=function(){var t=Object(o.useContext)(O).authState;return null!==t&&void 0!==t&&t.isLoggedIn?Object(nt.jsx)(u.b,{}):Object(nt.jsx)(u.a,{to:"/",replace:!0})},de=function(){var t=Object(u.g)(),e=Object(o.useState)(!1),n=Object(i.a)(e,2),a=n[0],r=n[1],c=oe(),b=Object(o.useReducer)(I,{},(function(){var t=S.authToken;if(t&&S.walletAddr){var e,n=(null!==(e=Nt.a.decode(t))&&void 0!==e?e:{}).addr;if(n===S.walletAddr)return{isLoggedIn:!0,walletAddr:n}}return S.clearAccountData(),{isLoggedIn:!1,walletAddr:""}})),j=Object(i.a)(b,2),x=j[0],h=j[1];return Object(o.useEffect)((function(){console.log("Check local account at:",t.pathname),S.authToken&&S.walletAddr?_().then((function(t){var e;if((null===(e=Nt.a.decode(t))||void 0===e?void 0:e.addr)!==S.walletAddr)throw new Error("Inconsistent address.");h({type:L.AUTO_SYNC,payload:{token:t}})})).catch((function(t){h({type:L.LOGOUT}),window.location.reload()})):h({type:L.LOGOUT}),window.scrollTo({top:0,behavior:"smooth"})}),[t]),Object(o.useEffect)((function(){function t(t){if(t.key===y)e(t.newValue)}var e=function(t){if(t&&S.walletAddr){var e=Nt.a.decode(t).addr;if(e===S.walletAddr)return void h({type:L.AUTO_SYNC,payload:{walletAddr:e,token:t}})}h({type:L.LOGOUT})};return window.addEventListener("storage",t),function(){window.removeEventListener("storage",t)}}),[]),Object(nt.jsx)(p.Provider,{value:{isLoading:a,setIsLoading:r},children:Object(nt.jsxs)(O.Provider,{value:{authState:x,authDispatcher:h},children:[Object(nt.jsx)(s.a,{container:document.body,children:Object(nt.jsx)(l.a,{sx:{zIndex:999999,backgroundColor:"rgba(0, 0, 0, 0.7)"},open:a,children:Object(nt.jsx)("img",{width:"100",alt:"loading",src:"/DSR-Editor/images/spinner.svg"})})}),Object(nt.jsx)(at,{}),Object(nt.jsx)(d.a,{sx:{width:"100%",height:{xs:"calc(100% - 56px)",sm:"calc(100% - 64px)"},mt:{xs:7,sm:8},boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"center",overflow:"overlay",scrollBehavior:"smooth"},ref:c,children:Object(nt.jsxs)(u.e,{children:[Object(nt.jsxs)(u.c,{path:"/",element:Object(nt.jsx)(u.b,{}),children:[Object(nt.jsx)(u.c,{index:!0,element:Object(nt.jsx)(ct,{})}),Object(nt.jsx)(u.c,{path:"rooms",element:Object(nt.jsx)(le,{}),children:Object(nt.jsxs)(u.c,{path:"",element:Object(nt.jsx)(se,{}),children:[Object(nt.jsx)(u.c,{index:!0,element:Object(nt.jsx)(Ft,{})}),Object(nt.jsx)(u.c,{path:":roomId",element:Object(nt.jsx)(ie,{})})]})}),Object(nt.jsx)(u.c,{path:"collections",element:Object(nt.jsx)(le,{}),children:Object(nt.jsx)(u.c,{path:"",element:Object(nt.jsx)(qt,{})})})]}),Object(nt.jsx)(u.c,{path:"*",element:Object(nt.jsx)(it,{})})]})})]})})},ue=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,608)).then((function(e){var n=e.getCLS,o=e.getFID,a=e.getFCP,r=e.getLCP,c=e.getTTFB;n(t),o(t),a(t),r(t),c(t)}))},be=n(593),je=n(582),xe=n(187),he=Object(je.a)(Object(xe.a)({palette:{mode:"dark",common:{black:"#000",white:"rgba(255, 255, 255, 0.8)"},primary:{main:"#78e5fe",dark:"#266d7d"},secondary:{main:"rgba(255, 255, 255, 0.7)"},error:{main:"#f44336",light:"#e57373",dark:"#d32f2f",contrastText:"rgba(255, 255, 255, 0.8)"},warning:{main:"#ffa726",light:"#ffb74d",dark:"#f57c00",contrastText:"rgba(0, 0, 0, 0.87)"},info:{main:"#29b6f6",light:"#4fc3f7",dark:"#0288d1",contrastText:"rgba(0, 0, 0, 0.87)"},success:{main:"#66bb6a",light:"#81c784",dark:"#388e3c",contrastText:"rgba(0, 0, 0, 0.87)"},grey:{50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},contrastThreshold:3,tonalOffset:.2,text:{primary:"rgba(255, 255, 255, 1)",secondary:"rgba(255, 255, 255, 0.6)",disabled:"rgba(255, 255, 255, 0.4)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{popup:"#242424",paper:"#161616",default:"#121212"},action:{active:"rgba(255, 255, 255, 0.8)",hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}},overrides:{}}));c.a.createRoot(document.getElementById("root")).render(Object(nt.jsx)(m.a,{children:Object(nt.jsx)(be.a,{theme:he,children:Object(nt.jsx)(a.a.StrictMode,{children:Object(nt.jsx)(de,{})})})})),console.log("console.log closed."),console.log=function(){},ue()}},[[522,1,2]]]);
//# sourceMappingURL=main.392b60d8.chunk.js.map