(this["webpackJsonpdsr-editor"]=this["webpackJsonpdsr-editor"]||[]).push([[0],{219:function(e,t){},327:function(e,t,n){},354:function(e,t){},360:function(e,t){},362:function(e,t){},372:function(e,t){},374:function(e,t){},384:function(e,t){},385:function(e,t){},428:function(e,t){},430:function(e,t){},437:function(e,t){},438:function(e,t){},518:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),r=n(283),c=n.n(r),i=(n(327),n(14)),s=n(569),l=n(597),u=n(568),d=n(31),j=n(532),b=n(567),h=n(588),x=n(590),f=n(584),p=n(50),O=Object(a.createContext)({authState:{isLoggedIn:!1,walletAddr:""},authDispatcher:function(){}}),m=Object(a.createContext)({isLoading:!1,setIsLoading:function(){}}),g=n(144),v=n.n(g),w="atk",y="addr",k={};Object.defineProperty(k,"authToken",{get:function(){return localStorage.getItem(w)},set:function(e){localStorage.setItem(w,e)}}),Object.defineProperty(k,"walletAddr",{get:function(){return v.a.load(y)},set:function(e){v.a.save(y,e,{path:"/"})}}),k.clearAccountData=function(){localStorage.removeItem(w),v.a.remove(y)};var C=k,S=function(e,t){var n,a=t.type,o=t.payload;console.log("dispatcher got state: ",a);var r=null!==(n=null===o||void 0===o?void 0:o.walletAddr)&&void 0!==n?n:"",c=null===o||void 0===o?void 0:o.token;switch(a){case A.AUTO_SYNC:return c?(C.authToken=c,e):e;case A.LOGIN:return C.authToken=c,C.walletAddr=r,{isLoggedIn:!0,walletAddr:r};case A.LOGOUT:return C.clearAccountData(),{isLoggedIn:!1,walletAddr:""};default:return e}},A={AUTO_SYNC:0,LOGIN:1,LOGOUT:2},I=n(53),L=n(0),D=n.n(L),T=n(97),z=n(292),R=n(301),E=n(6),W=n(5),P=n(9),G=n(10),U=n(17),F=n(295),B=n.n(F),N=(n(490),B.a.create({baseURL:"https://stormy-temple-44410.herokuapp.com/"}));N.interceptors.request.use((function(e){var t=C.authToken;return e.headers.Authorization=t?"Bearer ".concat(t):"",e}));var _=function(e){Object(P.a)(n,e);var t=Object(G.a)(n);function n(e){var a;for(var o in Object(W.a)(this,n),a=t.call(this),e)a.append(o,e[o]);return a}return Object(E.a)(n)}(Object(U.a)(FormData)),H=function(){var e=Object(I.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.get("/renew_token").then((function(e){return e.data.access_token}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(I.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.get("/login/".concat(t,"/payload")).then((function(e){return e.data.payload}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(I.a)(D.a.mark((function e(t,n){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.post("/login",new _({address:t,signature:n})).then((function(e){return e.data.access_token}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Y=function(){var e=Object(I.a)(D.a.mark((function e(t){var n;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.offset,e.next=3,N.get("/collections",{params:{offset:n}}).then((function(e){return e.data}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(I.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.get("/rooms").then((function(e){return e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(I.a)(D.a.mark((function e(t,n){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.post("/rooms/create",new _({name:t,image:null!==n&&void 0!==n?n:""})).then((function(e){return e.data.id}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),K=function(){var e=Object(I.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.delete("/rooms/".concat(t,"/delete"));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=new T.a("https://mainnet-tezos.giganode.io"),X=new z.a({name:"D Showroom"});Q.setWalletProvider(X);var Z=function(){var e=Object(a.useContext)(m).setIsLoading,t=Object(a.useContext)(O),n=(t.authState,t.authDispatcher),o=Object(a.useState)(""),r=Object(i.a)(o,2),c=r[0],s=r[1],l=function(){var e=Object(I.a)(D.a.mark((function e(){var t,n;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.client.getActiveAccount();case 2:(t=e.sent)?(n=t.address,c===n?console.log("Already connected: ",n):console.log("Another wallet connected: ",n)):console.log("No wallet connnection!");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var t=Object(I.a)(D.a.mark((function t(){var a,o,r,c;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(!0),t.prev=1,console.log("Requesting permissions..."),t.next=5,X.client.requestPermissions();case 5:return a=t.sent,o=a.address,s(o),console.log("Get permission. Get payload..."),t.next=11,q(o);case 11:return r=t.sent,console.log("Get payload. Request signature..."),t.next=15,X.client.requestSignPayload({signingType:R.a.MICHELINE,payload:r});case 15:return c=t.sent,console.log("Get signature. Try login..."),t.next=19,M(o,c.signature).then((function(e){console.log("Login suceed!"),n({type:A.LOGIN,payload:{walletAddr:o,token:e}})}));case 19:t.next=25;break;case 21:t.prev=21,t.t0=t.catch(1),s(""),console.log("Got error:",t.t0);case 25:e(!1);case 26:case"end":return t.stop()}}),t,null,[[1,21]])})));return function(){return t.apply(this,arguments)}}();return{walletAddr:c,connectWallet:u,checkWalletConnection:l}},$=n(46),ee=n(2),te=function(e){var t=e.children,n=e.to,a=Object(d.g)().pathname===n;return Object(ee.jsx)(p.b,{to:n,children:Object(ee.jsx)(j.a,{color:a?"text.primary":"text.secondary",sx:{fontSize:{sm:"1rem",xs:"0.875rem"},mr:4,fontWeight:"bold",position:"relative","&::after":a?{position:"absolute",content:"''",height:2,bottom:-3,margin:"0 auto",left:0,right:0,width:"100%",backgroundColor:"text.primary"}:{}},children:t})})},ne=function(){var e,t,n,o=Object(a.useContext)(O),r=o.authState,c=o.authDispatcher,i=Z().connectWallet,s=Object($.a)(),l=Object(b.a)(s.breakpoints.up("sm"));return Object(ee.jsx)(h.a,{color:"default",enableColorOnDark:!0,children:Object(ee.jsxs)(x.a,{children:[Object(ee.jsx)(p.b,{to:"/",children:Object(ee.jsx)("img",{style:{height:40},src:l?"/DSR-Editor/logo_full.svg":"/DSR-Editor/logo.svg",alt:"D SHOWROOM"})}),Object(ee.jsx)(j.a,{sx:{flexGrow:1}}),null!==r&&void 0!==r&&r.isLoggedIn?Object(ee.jsxs)(ee.Fragment,{children:[Object(ee.jsx)(te,{to:"/rooms",children:"Rooms"}),Object(ee.jsx)(te,{to:"/collections",children:"Collections"}),Object(ee.jsx)(f.a,{variant:"outlined",sx:{textTransform:"none"},onDoubleClick:function(){c({type:A.LOGOUT})},children:l?(null===r||void 0===r||null===(e=r.walletAddr)||void 0===e?void 0:e.slice(0,5))+"..."+(null===r||void 0===r||null===(t=r.walletAddr)||void 0===t?void 0:t.slice(-5)):"..."+(null===r||void 0===r||null===(n=r.walletAddr)||void 0===n?void 0:n.slice(-3))})]}):Object(ee.jsx)(f.a,{variant:"outlined",onClick:function(){i()},children:"Connect"})]})})},ae=n(44),oe=function(){var e=Object(d.h)(),t=Object(a.useContext)(O).authState,n=Z().connectWallet;return Object(ee.jsxs)(u.a,{sx:{height:"100%",width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[Object(ee.jsx)("img",{style:{minWidth:200,width:"50%",maxWidth:360,marginBottom:24},src:"/DSR-Editor/images/welcome.svg",alt:"Welcome to DSR."}),Object(ee.jsx)(f.a,{sx:{textAlign:"center",padding:2,mt:2.5},size:"large",onClick:null!==t&&void 0!==t&&t.isLoggedIn?function(t){e("/rooms"),t.preventDefault()}:function(e){n(),e.preventDefault()},href:"/rooms",children:Object(ee.jsx)(j.a,{variant:"h6",children:null!==t&&void 0!==t&&t.isLoggedIn?"Get Started":"Connect to Start"})})]})},re=function(){return Object(ee.jsxs)(u.a,{sx:{width:"100%",height:"100%"},children:[Object(ee.jsx)(u.a,{component:"img",src:"/DSR-Editor/images/test.jpg",sx:{width:"100%",height:"100%",objectFit:"cover",position:"absolute",zIndex:-1}}),Object(ee.jsx)(j.a,{variant:"h2",color:"text.primary",sx:{textAlign:"center",mt:"5%",fontWeight:"bold"},children:"Nothing here!!!"})]})},ce=n(585),ie=n(576),se=n(591),le=n(592),ue=n(593),de=n(594),je=n(578),be=n(595),he=n(582),xe=n(596),fe=n(574),pe=n(598),Oe=n(599),me=n(579),ge=n(600),ve=n(296),we=n.n(ve),ye=n(298),ke=n.n(ye),Ce=n(297),Se=n.n(Ce),Ae=function(e){var t,n=e.room,o=e.refetch,r=null!==n&&void 0!==n?n:{},c=r.image,s=r.name,l=r.id,b=Object(a.useState)(!1),h=Object(i.a)(b,2),x=h[0],p=h[1],O=Object(a.useState)(!1),g=Object(i.a)(O,2),v=g[0],w=g[1],y=Object(a.useContext)(m).setIsLoading,k=Object(a.useState)(!1),C=Object(i.a)(k,2),S=C[0],A=C[1],I=Object(a.useState)(""),L=Object(i.a)(I,2),D=L[0],T=L[1],z=Object(d.h)(),R=!s;return Object(ee.jsxs)(ee.Fragment,{children:[Object(ee.jsxs)(se.a,{sx:{width:360,margin:2,height:"max-content"},raised:!0,children:[Object(ee.jsxs)(u.a,{sx:{width:"100%",height:"auto",aspectRatio:"15/9",position:"relative",backgroundColor:"background.paper"},children:[!R&&Object(ee.jsx)(le.a,{component:"img",loading:"lazy",sx:{objectFit:"cover",width:"100%",height:"100%",zIndex:1,position:"absolute",top:0},onLoad:function(){w(!0)},image:(null!==(t=null===c||void 0===c?void 0:c.length)&&void 0!==t?t:0)>0?c:"/DSR-Editor/images/default.png"}),!v&&Object(ee.jsx)(ue.a,{sx:{zIndex:0,position:"absolute",top:0},variant:"rectangular",width:"100%",height:"100%",animation:"wave"})]}),Object(ee.jsxs)(de.a,{sx:{pt:1,"&:last-child":{paddingBottom:{sm:1.5,xs:1}},position:"relative"},children:[Object(ee.jsx)(j.a,{variant:"h6",sx:{mb:.5,lineHeight:1.6,width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:R?Object(ee.jsx)(ue.a,{}):s}),R?Object(ee.jsx)(ue.a,{width:"40%"}):Object(ee.jsx)(je.a,{title:"Click to copy",arrow:!0,followCursor:!0,children:Object(ee.jsxs)(j.a,{variant:"body2",color:"text.secondary",sx:{fontSize:{sm:"0.875rem",xs:"0.75rem"},width:"fit-content",display:"flex",flexDirection:"row",alignItems:"center",cursor:"pointer",lineHeight:1,"&:hover":{color:"text.primary",textDecoration:"underline dotted 2px"}},onClick:function(){navigator.clipboard.writeText(l).then((function(){p(!0)}))},children:[Object(ee.jsx)(we.a,{fontSize:"small",sx:{mr:.5,fontSize:{sm:"1.25rem",xs:"1rem"}}}),l]})}),!R&&Object(ee.jsxs)(ee.Fragment,{children:[Object(ee.jsx)(je.a,{title:"Delete",placement:"top",arrow:!0,componentsProps:{tooltip:{style:{marginBottom:8}}},children:Object(ee.jsx)(be.a,{color:"error",size:"small",sx:{position:"absolute",right:{sm:48,xs:40},bottom:{sm:8,xs:4}},onClick:function(){A(!0)},children:Object(ee.jsx)(Se.a,{sx:{fontSize:{sm:"1.5rem",xs:"1.25rem"}}})})}),Object(ee.jsx)(je.a,{title:"Edit",placement:"top",arrow:!0,componentsProps:{tooltip:{style:{marginBottom:8}}},children:Object(ee.jsx)(be.a,{color:"primary",size:"small",sx:{position:"absolute",right:8,bottom:{sm:8,xs:4}},onClick:function(){z(l)},children:Object(ee.jsx)(ke.a,{sx:{fontSize:{sm:"1.5rem",xs:"1.25rem"}}})})})]})]})]}),Object(ee.jsx)(he.a,{open:x,autoHideDuration:1e3,anchorOrigin:{vertical:"bottom",horizontal:"center"},onClose:Object(a.useCallback)((function(){p(!1)}),[]),message:"Room ID copied.",sx:{"& .MuiPaper-root":{maxWidth:"max-content",minWidth:"max-content",pl:3,pr:3}}}),Object(ee.jsxs)(xe.a,{open:S,maxWidth:"xs",fullWidth:!0,children:[Object(ee.jsx)(fe.a,{children:"Are you sure to delete the room?"}),Object(ee.jsxs)(pe.a,{children:[Object(ee.jsxs)(Oe.a,{component:"span",children:["Type the room name"," ",Object(ee.jsx)(j.a,{component:"span",color:"error",fontWeight:"bold",children:s})]}),Object(ee.jsx)(me.a,{variant:"standard",fullWidth:!0,value:D,onChange:Object(a.useCallback)((function(e){T(e.target.value)}),[])})]}),Object(ee.jsxs)(ge.a,{children:[Object(ee.jsx)(f.a,{onClick:Object(a.useCallback)((function(){A(!1)}),[]),children:"Cancel"}),Object(ee.jsx)(f.a,{color:"error",disabled:D!==s,onClick:function(){A(!1),y(!0),K(l).then((function(){null===o||void 0===o||o().then((function(){y(!1)}))}))},children:"Delete"})]})]})]})},Ie=n(300),Le=n.n(Ie),De=n(299),Te=["limit","value","onChange"],ze=function(e){var t=e.limit,n=void 0===t?32:t,o=(e.value,e.onChange),r=Object(De.a)(e,Te),c=Object(a.useState)(""),s=Object(i.a)(c,2),l=s[0],u=s[1],d=Object(a.useState)(!1),j=Object(i.a)(d,2),b=j[0],h=j[1],x=Object(a.useState)(l.length),f=Object(i.a)(x,2),p=f[0],O=f[1],m=function(e){var t=function(e,t){var n=[];return e.split("").forEach((function(e){e.match(/[\u0000-\u00ff]/)?n.push(e):n.push("",e)})),n.slice(0,t).join("")}(e.target.value,n);if(!b){e.target.value=t;var a=0;t.split("").forEach((function(e){e.match(/[\u0000-\u00ff]/)?a+=1:a+=2})),O(a)}u(t),null===o||void 0===o||o(e)};return Object(ee.jsx)(me.a,Object(ae.a)({value:l,onChange:m,inputProps:{onCompositionStart:Object(a.useCallback)((function(e){h(!0)}),[]),onCompositionEnd:Object(a.useCallback)((function(e){m(e),h(!1)}),[]),onBlur:Object(a.useCallback)((function(e){e.target.value=e.target.value.trim(),m(e)}),[])},helperText:"(".concat(p,"/").concat(n,")")},r))},Re=function(e){var t=e.open,n=e.onClose,o=Object(d.h)(),r=Object(a.useState)(""),c=Object(i.a)(r,2),s=c[0],l=c[1],u=Object(a.useContext)(m).setIsLoading;return Object(ee.jsxs)(xe.a,{open:t,PaperProps:{sx:{padding:1}},onClose:n,children:[Object(ee.jsx)(fe.a,{sx:{pb:1},children:"Create New Showroom"}),Object(ee.jsxs)(pe.a,{children:[Object(ee.jsx)(Oe.a,{sx:{mb:2},children:"To create a new showroom, please give it a name."}),Object(ee.jsx)("img",{style:{aspectRatio:16/9,objectFit:"cover"},width:"100%",alt:"default",src:"/DSR-Editor/images/default.png"}),Object(ee.jsx)(ze,{sx:{mt:2},variant:"standard",fullWidth:!0,placeholder:"Showroom name",value:s,onChange:Object(a.useCallback)((function(e){l(e.target.value)}),[])})]}),Object(ee.jsxs)(ge.a,{sx:{pr:2},children:[Object(ee.jsx)(f.a,{onClick:n,color:"error",children:"Cancel"}),Object(ee.jsx)(f.a,{onClick:function(){u(!0),0===s.trim().length&&alert("Please set a name."),V(s).then((function(e){u(!1),o(e)}))},disabled:!s,children:"Create"})]})]})},Ee=function(){var e=Object(d.i)(),t=e.roomList,n=e.fetchRooms,o=Object(a.useState)(!1),r=Object(i.a)(o,2),c=r[0],s=r[1],l={item:!0,container:!0,direction:"row",justifyContent:"center",xs:12,md:6,lg:4,xl:3};return Object(ee.jsxs)(ie.a,{sx:{padding:"36px 24px",boxSizing:"border-box",width:"100%"},children:[Object(ee.jsx)(ce.a,{container:!0,direction:"row",sx:{margin:"auto",width:"90%",maxWidth:1600},children:t?Object(ee.jsxs)(ee.Fragment,{children:[t.map((function(e){return Object(ee.jsx)(ce.a,Object(ae.a)(Object(ae.a)({},l),{},{children:Object(ee.jsx)(Ae,{room:e,refetch:n})}),e.id)})),Object(ee.jsx)(ce.a,Object(ae.a)(Object(ae.a)({},l),{},{color:"divider",children:Object(ee.jsx)(f.a,{variant:"outlined",color:"inherit",sx:{width:360,margin:2,borderWidth:3},onClick:function(){s(!0)},children:Object(ee.jsx)(Le.a,{sx:{fontSize:80}})})}))]}):Array.from({length:4},(function(){return{}})).map((function(e,t){return Object(ee.jsx)(ce.a,Object(ae.a)(Object(ae.a)({},l),{},{children:Object(ee.jsx)(Ae,{})}),t)}))}),Object(ee.jsx)(Re,{open:c,onClose:Object(a.useCallback)((function(){s(!1)}),[])})]})},We=n(145),Pe=n.n(We),Ge=n(3),Ue=n(586),Fe=n(581),Be=function(e){var t=e.collection,n=null!==t&&void 0!==t?t:{},o=n.name,r=n.thumbnailUri,c=n.displayUri,s=n.artifactUri,l=n.mimeType,u=!o,d=Object(a.useState)(!1),b=Object(i.a)(d,2),h=b[0],x=b[1];return Object(ee.jsxs)(se.a,{sx:{width:270,margin:2,height:"max-content"},children:[Object(ee.jsxs)(ie.a,{sx:{width:"100%",height:"auto",position:"relative",aspectRatio:"1",backgroundColor:"background.paper"},children:[!u&&Object(ee.jsx)(le.a,{sx:{objectFit:"contain",width:"100%",height:"100%",zIndex:1,position:"absolute",top:0},component:l.includes("video")?"video":"img",image:l.includes("image")||l.includes("video")?s:null!==c&&void 0!==c?c:r,controls:!0,loop:!0,loading:"lazy",onLoad:function(){x(!0)},onLoadStart:function(){x(!0)}}),!h&&Object(ee.jsx)(ue.a,{sx:{zIndex:0,position:"absolute",top:0},variant:"rectangular",width:"100%",height:"100%",animation:"wave"})]}),Object(ee.jsx)(de.a,{sx:{width:"100%",boxSizing:"border-box","&:last-child":{paddingBottom:1.5}},children:Object(ee.jsx)(j.a,{variant:"body1",sx:{mb:.5,width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:u?Object(ee.jsx)(ue.a,{}):o})})]})},Ne=function(){var e,t=Object(a.useState)({}),n=Object(i.a)(t,2),o=n[0],r=n[1],c=Object(a.useState)({}),s=Object(i.a)(c,2),l=s[0],b=s[1],h=Object(d.g)(),x=new URLSearchParams(h.search),f=parseInt(x.get("page")||"1",10);Object(a.useEffect)((function(){var e=24*(f-1);o[f]||r(Object(ae.a)(Object(Ge.a)({},f,Array.from({length:24},(function(){return{}}))),o));var t=function(){var t=Object(I.a)(D.a.mark((function t(){var n,a,c;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y({offset:e});case 2:n=t.sent,a=n.tokens,c=n.count,r(Object(ae.a)(Object(Ge.a)({},f,a),o)),b(c);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[f]);var O={item:!0,container:!0,direction:"row",justifyContent:"center",xs:12,sm:6,md:4,lg:3,xl:2};return Object(ee.jsxs)(u.a,{sx:{position:"relative",padding:"36px 24px",boxSizing:"border-box",minHeight:"100%",width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(ee.jsx)(ce.a,{container:!0,direction:"row",sx:{pb:10},children:null===o||void 0===o||null===(e=o[f])||void 0===e?void 0:e.map((function(e,t){var n;return Object(ee.jsx)(ce.a,Object(ae.a)(Object(ae.a)({},O),{},{children:Object(ee.jsx)(Be,{collection:e})}),"collection_".concat(null!==(n=null===e||void 0===e?void 0:e.name)&&void 0!==n?n:t))}))}),0===l&&Object(ee.jsx)(j.a,{variant:"h2",color:"text.primary",sx:{textAlign:"center",mt:"5%",fontWeight:"bold"},children:"You don't have any collection!"}),(null!==l&&void 0!==l?l:0)>24&&Object(ee.jsx)(Ue.a,{color:"primary",sx:function(e){return{zIndex:100,position:"fixed",bottom:20,borderRadius:"9999px",display:"flex",backgroundColor:"".concat(e.palette.background.default,"88"),flexDirection:"row",justifyContent:"center",alignItems:"center",mt:1.5,padding:1}},page:f,count:Math.ceil(l/24),renderItem:function(e){return Object(ee.jsx)(Fe.a,Object(ae.a)({component:p.b,to:"".concat(1===e.page?"":"?page=".concat(e.page))},e))}})]})},_e=function(){var e=Object(d.j)().roomId;return Object(ee.jsx)(u.a,{children:e})},He=function(){var e=Object(a.useState)(),t=Object(i.a)(e,2),n=t[0],o=t[1],r=Object(d.g)(),c=function(){return J().then((function(e){o(e)})).catch((function(e){alert(e)}))};return Object(a.useEffect)((function(){console.log("(Re)fetch rooms..."),c()}),[r.pathname]),Object(ee.jsx)(d.b,{context:{roomList:n,fetchRooms:c}})},qe=function(){var e=Object(a.useContext)(O).authState;return null!==e&&void 0!==e&&e.isLoggedIn?Object(ee.jsx)(d.b,{}):Object(ee.jsx)(d.a,{to:"/",replace:!0})},Me=function(){var e=Object(d.g)(),t=Object(a.useState)(!1),n=Object(i.a)(t,2),o=n[0],r=n[1],c=Object(a.useReducer)(S,{},(function(){var e=C.authToken;if(e&&C.walletAddr){var t,n=(null!==(t=Pe.a.decode(e))&&void 0!==t?t:{}).addr;if(n===C.walletAddr)return{isLoggedIn:!0,walletAddr:n}}return C.clearAccountData(),{isLoggedIn:!1,walletAddr:""}})),j=Object(i.a)(c,2),b=j[0],h=j[1];return Object(a.useEffect)((function(){console.log("Check local account at:",e.pathname),C.authToken&&C.walletAddr?H().then((function(e){var t;if((null===(t=Pe.a.decode(e))||void 0===t?void 0:t.addr)!==C.walletAddr)throw new Error("Inconsistent address.");h({type:A.AUTO_SYNC,payload:{token:e}})})).catch((function(e){h({type:A.LOGOUT}),window.location.reload()})):h({type:A.LOGOUT}),window.scrollTo({top:0,behavior:"smooth"})}),[e]),Object(a.useEffect)((function(){function e(e){if(e.key===w)t(e.newValue)}var t=function(e){if(e&&C.walletAddr){var t=Pe.a.decode(e).addr;if(t===C.walletAddr)return void h({type:A.AUTO_SYNC,payload:{walletAddr:t,token:e}})}h({type:A.LOGOUT})};return window.addEventListener("storage",e),function(){window.removeEventListener("storage",e)}}),[]),Object(ee.jsx)(m.Provider,{value:{isLoading:o,setIsLoading:r},children:Object(ee.jsxs)(O.Provider,{value:{authState:b,authDispatcher:h},children:[Object(ee.jsx)(s.a,{container:document.body,children:Object(ee.jsx)(l.a,{sx:{zIndex:999999,backgroundColor:"rgba(0, 0, 0, 0.7)"},open:o,children:Object(ee.jsx)("img",{width:"100",alt:"loading",src:"/DSR-Editor/images/spinner.svg"})})}),Object(ee.jsx)(ne,{}),Object(ee.jsx)(u.a,{sx:{width:"100%",height:{xs:"calc(100% - 56px)",sm:"calc(100% - 64px)"},mt:{xs:7,sm:8},boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"center",overflow:"auto",scrollBehavior:"smooth"},children:Object(ee.jsxs)(d.e,{children:[Object(ee.jsxs)(d.c,{path:"/",element:Object(ee.jsx)(d.b,{}),children:[Object(ee.jsx)(d.c,{index:!0,element:Object(ee.jsx)(oe,{})}),Object(ee.jsx)(d.c,{path:"rooms",element:Object(ee.jsx)(qe,{}),children:Object(ee.jsxs)(d.c,{path:"",element:Object(ee.jsx)(He,{}),children:[Object(ee.jsx)(d.c,{index:!0,element:Object(ee.jsx)(Ee,{})}),Object(ee.jsx)(d.c,{path:":roomId",element:Object(ee.jsx)(_e,{})})]})}),Object(ee.jsx)(d.c,{path:"collections",element:Object(ee.jsx)(qe,{}),children:Object(ee.jsx)(d.c,{path:"",element:Object(ee.jsx)(Ne,{})})})]}),Object(ee.jsx)(d.c,{path:"*",element:Object(ee.jsx)(re,{})})]})})]})})},Ye=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,601)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),o(e),r(e),c(e)}))},Je=n(587),Ve=n(577),Ke=n(184),Qe=Object(Ve.a)(Object(Ke.a)({palette:{mode:"dark",common:{black:"#000",white:"rgba(255, 255, 255, 0.8)"},primary:{main:"#78e5fe"},secondary:{main:"rgba(255, 255, 255, 0.7)"},error:{main:"#f44336",light:"#e57373",dark:"#d32f2f",contrastText:"rgba(255, 255, 255, 0.8)"},warning:{main:"#ffa726",light:"#ffb74d",dark:"#f57c00",contrastText:"rgba(0, 0, 0, 0.87)"},info:{main:"#29b6f6",light:"#4fc3f7",dark:"#0288d1",contrastText:"rgba(0, 0, 0, 0.87)"},success:{main:"#66bb6a",light:"#81c784",dark:"#388e3c",contrastText:"rgba(0, 0, 0, 0.87)"},grey:{50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},contrastThreshold:3,tonalOffset:.2,text:{primary:"rgba(255, 255, 255, 1)",secondary:"rgba(255, 255, 255, 0.6)",disabled:"rgba(255, 255, 255, 0.4)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{popup:"#242424",paper:"#161616",default:"#121212"},action:{active:"rgba(255, 255, 255, 0.8)",hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}},overrides:{}}));c.a.createRoot(document.getElementById("root")).render(Object(ee.jsx)(p.a,{children:Object(ee.jsx)(Je.a,{theme:Qe,children:Object(ee.jsx)(o.a.StrictMode,{children:Object(ee.jsx)(Me,{})})})})),Ye()}},[[518,1,2]]]);
//# sourceMappingURL=main.f73e70c3.chunk.js.map